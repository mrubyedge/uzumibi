desc: Test uzumibi CLI help command
vars:
  binary: ${UZUMIBI_TEST_BINARY:-../target/release/uzumibi}
  version: 0.5.0
steps:
  build:
    desc: Build release binary
    exec:
      command: cargo build --release --quiet
    test: current.exit_code == 0

  main_help:
    desc: Show main help
    exec:
      command: "{{ vars.binary }} --help"
    test: |
      current.exit_code == 0 &&
      current.stdout contains 'Uzumibi CLI'

  new_help:
    desc: Show new subcommand help
    exec:
      command: "{{ vars.binary }} new --help"
    test: |
      current.exit_code == 0 &&
      current.stdout contains 'Usage: uzumibi new [OPTIONS] --template <TEMPLATE> <PROJECT_NAME>'

  version:
    desc: Show version
    exec:
      command: "{{ vars.binary }} --version | grep {{ vars.version }}"
    test: |
      current.exit_code == 0 &&
      current.stdout contains "uzumibi"
